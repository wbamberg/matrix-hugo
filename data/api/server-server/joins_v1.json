{
    "__meta": {
        "base": "/_matrix/federation/v1",
        "endpoints": [
            {
                "deprecated": false,
                "desc": "Asks the receiving server to return information that the sending\nserver will need to prepare a join event to get into the room.",
                "example": {
                    "req": "GET /_matrix/federation/v1/make_join/%21abc123%3Amatrix.org/%40someone%3Aexample.org?ver=1&ver=2 HTTP/1.1\n\n"
                },
                "method": "GET",
                "path": "/_matrix/federation/v1/make_join/{roomId}/{userId}",
                "rate_limited": false,
                "req_body_tables": [],
                "req_param_by_loc": {
                    "path": [
                        {
                            "desc": "**Required.** The room ID that is about to be joined.",
                            "key": "roomId",
                            "required": false,
                            "title": "string"
                        },
                        {
                            "desc": "**Required.** The user ID the join event will be for.",
                            "key": "userId",
                            "required": false,
                            "title": "string"
                        }
                    ],
                    "query": [
                        {
                            "desc": "The room versions the sending server has support for. Defaults\nto ``[1]``.",
                            "key": "ver",
                            "required": false,
                            "title": "[string]"
                        }
                    ]
                },
                "requires_auth": true,
                "res_headers": null,
                "res_tables": [
                    [
                        null,
                        null,
                        [
                            {
                                "desc": "The version of the room where the server is trying to join. If not provided,\nthe room version is assumed to be either \"1\" or \"2\".",
                                "key": "room_version",
                                "required": false,
                                "title": "string"
                            },
                            {
                                "desc": "An unsigned template event. Note that events have a different format\ndepending on the room version - check the `room version specification`_\nfor precise event formats.",
                                "key": "event",
                                "required": false,
                                "title": "Event Template"
                            }
                        ]
                    ],
                    [
                        "Event Template",
                        null,
                        [
                            {
                                "desc": "**Required.** The user ID of the joining member.",
                                "key": "sender",
                                "required": true,
                                "title": "string"
                            },
                            {
                                "desc": "**Required.** The name of the resident homeserver.",
                                "key": "origin",
                                "required": true,
                                "title": "string"
                            },
                            {
                                "desc": "**Required.** A timestamp added by the resident homeserver.",
                                "key": "origin_server_ts",
                                "required": true,
                                "title": "integer"
                            },
                            {
                                "desc": "**Required.** The value ``m.room.member``.",
                                "key": "type",
                                "required": true,
                                "title": "string"
                            },
                            {
                                "desc": "**Required.** The user ID of the joining member.",
                                "key": "state_key",
                                "required": true,
                                "title": "string"
                            },
                            {
                                "desc": "**Required.** The content of the event.",
                                "key": "content",
                                "required": true,
                                "title": "Membership Event Content"
                            }
                        ]
                    ],
                    [
                        "Membership Event Content",
                        null,
                        [
                            {
                                "desc": "**Required.** The value ``join``.",
                                "key": "membership",
                                "required": true,
                                "title": "string"
                            }
                        ]
                    ]
                ],
                "responses": [
                    {
                        "code": 200,
                        "description": "A template to be used for the rest of the `Joining Rooms`_ handshake. Note that\nevents have a different format depending on the room version - check the\n`room version specification`_ for precise event formats. **The response body\nhere describes the common event fields in more detail and may be missing other\nrequired fields for a PDU.**",
                        "example": "{\n  \"room_version\": \"2\",\n  \"event\": {\n    \"type\": \"m.room.member\",\n    \"room_id\": \"!somewhere:example.org\",\n    \"content\": {\n      \"membership\": \"join\"\n    },\n    \"state_key\": \"@someone:example.org\",\n    \"origin\": \"example.org\",\n    \"origin_server_ts\": 1549041175876,\n    \"sender\": \"@someone:example.org\"\n  }\n}"
                    },
                    {
                        "code": 400,
                        "description": "The request is invalid or the room the server is attempting\nto join has a version that is not listed in the ``ver``\nparameters.\n\nThe error should be passed through to clients so that they\nmay give better feedback to users.",
                        "example": "{\n  \"errcode\": \"M_INCOMPATIBLE_ROOM_VERSION\",\n  \"error\": \"Your homeserver does not support the features required to join this room\",\n  \"room_version\": \"3\"\n}"
                    },
                    {
                        "code": 404,
                        "description": "The room that the joining server is attempting to join is unknown\nto the receiving server.",
                        "example": "{\n  \"errcode\": \"M_NOT_FOUND\",\n  \"error\": \"Unknown room\"\n}"
                    }
                ],
                "title": "Get information required to make a join event for a room"
            },
            {
                "deprecated": false,
                "desc": ".. Note::\n   Servers should instead prefer to use the v2 ``/send_join``\n   endpoint.\n\nSubmits a signed join event to the resident server for it\nto accept it into the room's graph. Note that events have\na different format depending on the room version - check\nthe `room version specification`_ for precise event formats.\n**The request and response body here describe the common\nevent fields in more detail and may be missing other required\nfields for a PDU.**",
                "example": {
                    "req": "PUT /_matrix/federation/v1/send_join/%21abc123%3Amatrix.org/%24abc123%3Aexample.org HTTP/1.1\nContent-Type: application/json\n\n{\n  \"sender\": \"@someone:example.org\",\n  \"origin\": \"matrix.org\",\n  \"origin_server_ts\": 1234567890,\n  \"type\": \"m.room.member\",\n  \"state_key\": \"@someone:example.org\",\n  \"content\": {\n    \"membership\": \"join\"\n  }\n}"
                },
                "method": "PUT",
                "path": "/_matrix/federation/v1/send_join/{roomId}/{eventId}",
                "rate_limited": false,
                "req_body_tables": [
                    [
                        "Membership Event Content",
                        null,
                        [
                            {
                                "desc": "**Required.** The value ``join``.",
                                "key": "membership",
                                "required": true,
                                "title": "string"
                            }
                        ]
                    ]
                ],
                "req_param_by_loc": {
                    "JSON body": [
                        {
                            "desc": "**Required.** The user ID of the joining member.",
                            "key": "sender",
                            "required": true,
                            "title": "string"
                        },
                        {
                            "desc": "**Required.** The name of the joining homeserver.",
                            "key": "origin",
                            "required": true,
                            "title": "string"
                        },
                        {
                            "desc": "**Required.** A timestamp added by the joining homeserver.",
                            "key": "origin_server_ts",
                            "required": true,
                            "title": "integer"
                        },
                        {
                            "desc": "**Required.** The value ``m.room.member``.",
                            "key": "type",
                            "required": true,
                            "title": "string"
                        },
                        {
                            "desc": "**Required.** The user ID of the joining member.",
                            "key": "state_key",
                            "required": true,
                            "title": "string"
                        },
                        {
                            "desc": "**Required.** The content of the event.",
                            "key": "content",
                            "required": true,
                            "title": "Membership Event Content"
                        }
                    ],
                    "path": [
                        {
                            "desc": "**Required.** The room ID that is about to be joined.",
                            "key": "roomId",
                            "required": false,
                            "title": "string"
                        },
                        {
                            "desc": "**Required.** The event ID for the join event.",
                            "key": "eventId",
                            "required": false,
                            "title": "string"
                        }
                    ]
                },
                "requires_auth": true,
                "res_headers": null,
                "res_tables": [
                    [
                        null,
                        null,
                        [
                            {
                                "desc": "",
                                "key": "<body>",
                                "required": false,
                                "title": "[integer, Room State]"
                            }
                        ]
                    ],
                    [
                        "Room State",
                        null,
                        [
                            {
                                "desc": "**Required.** The resident server's DNS name.",
                                "key": "origin",
                                "required": true,
                                "title": "string"
                            },
                            {
                                "desc": "**Required.** The auth chain for the entire current room state prior to the join event.\n\nNote that events have a different format depending on the room version - check the\n`room version specification`_ for precise event formats.",
                                "key": "auth_chain",
                                "required": true,
                                "title": "[PDU]"
                            },
                            {
                                "desc": "**Required.** The resolved current room state prior to the join event.\n\nThe event format varies depending on the room version - check the `room version specification`_\nfor precise event formats.",
                                "key": "state",
                                "required": true,
                                "title": "[PDU]"
                            }
                        ]
                    ]
                ],
                "responses": [
                    {
                        "code": 200,
                        "description": "The full state for the room, having accepted the join event.",
                        "example": "[\n  200,\n  {\n    \"origin\": \"matrix.org\",\n    \"auth_chain\": [\n      {\n        \"type\": \"m.room.minimal_pdu\",\n        \"room_id\": \"!somewhere:example.org\",\n        \"content\": {\n          \"see_room_version_spec\": \"The event format changes depending on the room version.\"\n        }\n      }\n    ],\n    \"state\": [\n      {\n        \"type\": \"m.room.minimal_pdu\",\n        \"room_id\": \"!somewhere:example.org\",\n        \"content\": {\n          \"see_room_version_spec\": \"The event format changes depending on the room version.\"\n        }\n      }\n    ]\n  }\n]"
                    }
                ],
                "title": "Submit a signed join event to a resident server"
            }
        ],
        "group": "joins_v1_ss"
    },
    "basePath": "/_matrix/federation/v1",
    "consumes": [
        "application/json"
    ],
    "host": "localhost:8448",
    "info": {
        "title": "Matrix Federation Join Room API",
        "version": "1.0.0"
    },
    "paths": {
        "/make_join/{roomId}/{userId}": {
            "get": {
                "description": "Asks the receiving server to return information that the sending\nserver will need to prepare a join event to get into the room.",
                "operationId": "makeJoin",
                "parameters": [
                    {
                        "description": "The room ID that is about to be joined.",
                        "in": "path",
                        "name": "roomId",
                        "required": true,
                        "type": "string",
                        "x-example": "!abc123:matrix.org"
                    },
                    {
                        "description": "The user ID the join event will be for.",
                        "in": "path",
                        "name": "userId",
                        "required": true,
                        "type": "string",
                        "x-example": "@someone:example.org"
                    },
                    {
                        "description": "The room versions the sending server has support for. Defaults\nto ``[1]``.",
                        "in": "query",
                        "items": {
                            "type": "string"
                        },
                        "name": "ver",
                        "type": "array",
                        "x-example": [
                            "1",
                            "2"
                        ]
                    }
                ],
                "responses": {
                    "200": {
                        "description": "A template to be used for the rest of the `Joining Rooms`_ handshake. Note that\nevents have a different format depending on the room version - check the\n`room version specification`_ for precise event formats. **The response body\nhere describes the common event fields in more detail and may be missing other\nrequired fields for a PDU.**",
                        "examples": {
                            "application/json": {
                                "event": {
                                    "content": {
                                        "membership": "join"
                                    },
                                    "origin": "example.org",
                                    "origin_server_ts": 1549041175876,
                                    "room_id": "!somewhere:example.org",
                                    "sender": "@someone:example.org",
                                    "state_key": "@someone:example.org",
                                    "type": "m.room.member"
                                },
                                "room_version": "2"
                            }
                        },
                        "schema": {
                            "properties": {
                                "event": {
                                    "description": "An unsigned template event. Note that events have a different format\ndepending on the room version - check the `room version specification`_\nfor precise event formats.",
                                    "properties": {
                                        "content": {
                                            "description": "The content of the event.",
                                            "example": {
                                                "membership": "join"
                                            },
                                            "properties": {
                                                "membership": {
                                                    "description": "The value ``join``.",
                                                    "example": "join",
                                                    "type": "string"
                                                }
                                            },
                                            "required": [
                                                "membership"
                                            ],
                                            "title": "Membership Event Content",
                                            "type": "object"
                                        },
                                        "origin": {
                                            "description": "The name of the resident homeserver.",
                                            "example": "matrix.org",
                                            "type": "string"
                                        },
                                        "origin_server_ts": {
                                            "description": "A timestamp added by the resident homeserver.",
                                            "example": 1234567890,
                                            "format": "int64",
                                            "type": "integer"
                                        },
                                        "sender": {
                                            "description": "The user ID of the joining member.",
                                            "example": "@someone:example.org",
                                            "type": "string"
                                        },
                                        "state_key": {
                                            "description": "The user ID of the joining member.",
                                            "example": "@someone:example.org",
                                            "type": "string"
                                        },
                                        "type": {
                                            "description": "The value ``m.room.member``.",
                                            "example": "m.room.member",
                                            "type": "string"
                                        }
                                    },
                                    "required": [
                                        "state_key",
                                        "origin",
                                        "origin_server_ts",
                                        "type",
                                        "content",
                                        "sender"
                                    ],
                                    "title": "Event Template",
                                    "type": "object"
                                },
                                "room_version": {
                                    "description": "The version of the room where the server is trying to join. If not provided,\nthe room version is assumed to be either \"1\" or \"2\".",
                                    "example": "2",
                                    "type": "string"
                                }
                            },
                            "type": "object"
                        }
                    },
                    "400": {
                        "description": "The request is invalid or the room the server is attempting\nto join has a version that is not listed in the ``ver``\nparameters.\n\nThe error should be passed through to clients so that they\nmay give better feedback to users.",
                        "examples": {
                            "application/json": {
                                "errcode": "M_INCOMPATIBLE_ROOM_VERSION",
                                "error": "Your homeserver does not support the features required to join this room",
                                "room_version": "3"
                            }
                        },
                        "schema": {
                            "allOf": [
                                {
                                    "description": "A Matrix-level Error",
                                    "properties": {
                                        "errcode": {
                                            "description": "An error code.",
                                            "example": "M_UNKNOWN",
                                            "type": "string"
                                        },
                                        "error": {
                                            "description": "A human-readable error message.",
                                            "example": "An unknown error occurred",
                                            "type": "string"
                                        }
                                    },
                                    "required": [
                                        "errcode"
                                    ],
                                    "type": "object"
                                },
                                {
                                    "properties": {
                                        "room_version": {
                                            "description": "The version of the room. Required if the ``errcode``\nis ``M_INCOMPATIBLE_ROOM_VERSION``.",
                                            "type": "string"
                                        }
                                    },
                                    "type": "object"
                                }
                            ]
                        }
                    },
                    "404": {
                        "description": "The room that the joining server is attempting to join is unknown\nto the receiving server.",
                        "examples": {
                            "application/json": {
                                "errcode": "M_NOT_FOUND",
                                "error": "Unknown room"
                            }
                        }
                    }
                },
                "security": [
                    {
                        "signedRequest": []
                    }
                ],
                "summary": "Get information required to make a join event for a room"
            }
        },
        "/send_join/{roomId}/{eventId}": {
            "put": {
                "description": ".. Note::\n   Servers should instead prefer to use the v2 ``/send_join``\n   endpoint.\n\nSubmits a signed join event to the resident server for it\nto accept it into the room's graph. Note that events have\na different format depending on the room version - check\nthe `room version specification`_ for precise event formats.\n**The request and response body here describe the common\nevent fields in more detail and may be missing other required\nfields for a PDU.**",
                "operationId": "sendJoinV1",
                "parameters": [
                    {
                        "description": "The room ID that is about to be joined.",
                        "in": "path",
                        "name": "roomId",
                        "required": true,
                        "type": "string",
                        "x-example": "!abc123:matrix.org"
                    },
                    {
                        "description": "The event ID for the join event.",
                        "in": "path",
                        "name": "eventId",
                        "required": true,
                        "type": "string",
                        "x-example": "$abc123:example.org"
                    },
                    {
                        "example": {
                            "content": {
                                "membership": "join"
                            },
                            "origin": "example.org",
                            "origin_server_ts": 1549041175876,
                            "room_id": "!somewhere:example.org",
                            "sender": "@someone:example.org",
                            "state_key": "@someone:example.org",
                            "type": "m.room.member"
                        },
                        "in": "body",
                        "name": "body",
                        "required": true,
                        "schema": {
                            "properties": {
                                "content": {
                                    "description": "The content of the event.",
                                    "example": {
                                        "membership": "join"
                                    },
                                    "properties": {
                                        "membership": {
                                            "description": "The value ``join``.",
                                            "example": "join",
                                            "type": "string"
                                        }
                                    },
                                    "required": [
                                        "membership"
                                    ],
                                    "title": "Membership Event Content",
                                    "type": "object"
                                },
                                "origin": {
                                    "description": "The name of the joining homeserver.",
                                    "example": "matrix.org",
                                    "type": "string"
                                },
                                "origin_server_ts": {
                                    "description": "A timestamp added by the joining homeserver.",
                                    "example": 1234567890,
                                    "format": "int64",
                                    "type": "integer"
                                },
                                "sender": {
                                    "description": "The user ID of the joining member.",
                                    "example": "@someone:example.org",
                                    "type": "string"
                                },
                                "state_key": {
                                    "description": "The user ID of the joining member.",
                                    "example": "@someone:example.org",
                                    "type": "string"
                                },
                                "type": {
                                    "description": "The value ``m.room.member``.",
                                    "example": "m.room.member",
                                    "type": "string"
                                }
                            },
                            "required": [
                                "state_key",
                                "sender",
                                "origin",
                                "origin_server_ts",
                                "type",
                                "content"
                            ],
                            "type": "object"
                        },
                        "type": "object"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "The full state for the room, having accepted the join event.",
                        "examples": {
                            "application/json": [
                                200,
                                {
                                    "auth_chain": [
                                        {
                                            "content": {
                                                "see_room_version_spec": "The event format changes depending on the room version."
                                            },
                                            "room_id": "!somewhere:example.org",
                                            "type": "m.room.minimal_pdu"
                                        }
                                    ],
                                    "origin": "matrix.org",
                                    "state": [
                                        {
                                            "content": {
                                                "see_room_version_spec": "The event format changes depending on the room version."
                                            },
                                            "room_id": "!somewhere:example.org",
                                            "type": "m.room.minimal_pdu"
                                        }
                                    ]
                                }
                            ]
                        },
                        "schema": {
                            "items": [
                                {
                                    "description": "The value ``200``.",
                                    "example": 200,
                                    "type": "integer"
                                },
                                {
                                    "description": "The state for the room.",
                                    "properties": {
                                        "auth_chain": {
                                            "description": "The auth chain for the entire current room state prior to the join event.\n\nNote that events have a different format depending on the room version - check the\n`room version specification`_ for precise event formats.",
                                            "items": {
                                                "description": "The `PDUs <#pdus>`_ that make up the auth chain. The event format varies depending\non the room version - check the `room version specification`_ for precise event formats.",
                                                "example": {
                                                    "content": {
                                                        "see_room_version_spec": "The event format changes depending on the room version."
                                                    },
                                                    "room_id": "!somewhere:example.org",
                                                    "type": "m.room.minimal_pdu"
                                                },
                                                "schema": {
                                                    "properties": [],
                                                    "type": "object"
                                                },
                                                "title": "PDU",
                                                "type": "object"
                                            },
                                            "type": "array"
                                        },
                                        "origin": {
                                            "description": "The resident server's DNS name.",
                                            "type": "string"
                                        },
                                        "state": {
                                            "description": "The resolved current room state prior to the join event.\n\nThe event format varies depending on the room version - check the `room version specification`_\nfor precise event formats.",
                                            "items": {
                                                "description": "The `PDUs <#pdus>`_ for the fully resolved state of the room. The event format varies depending\non the room version - check the `room version specification`_ for precise event formats.",
                                                "example": {
                                                    "content": {
                                                        "see_room_version_spec": "The event format changes depending on the room version."
                                                    },
                                                    "room_id": "!somewhere:example.org",
                                                    "type": "m.room.minimal_pdu"
                                                },
                                                "schema": {
                                                    "properties": [],
                                                    "type": "object"
                                                },
                                                "title": "PDU",
                                                "type": "object"
                                            },
                                            "type": "array"
                                        }
                                    },
                                    "required": [
                                        "auth_chain",
                                        "state",
                                        "origin"
                                    ],
                                    "title": "Room State",
                                    "type": "object"
                                }
                            ],
                            "maxItems": 2,
                            "minItems": 2,
                            "type": "array"
                        }
                    }
                },
                "security": [
                    {
                        "signedRequest": []
                    }
                ],
                "summary": "Submit a signed join event to a resident server"
            }
        }
    },
    "produces": [
        "application/json"
    ],
    "schemes": [
        "https"
    ],
    "securityDefinitions": {
        "signedRequest": {
            "description": "The ``Authorization`` header defined in the `Authentication`_ section.",
            "in": "header",
            "name": "Authorization",
            "type": "apiKey"
        }
    },
    "swagger": "2.0"
}