{
    "__meta": {
        "base": "/_matrix/federation/v2",
        "endpoints": [
            {
                "deprecated": false,
                "desc": ".. Note::\n   This API is nearly identical to the v1 API with the exception of the request\n   body being different, and the response format fixed.\n\nInvites a remote user to a room. Once the event has been  signed by both the inviting\nhomeserver and the invited homeserver, it can be sent to all of the servers in the\nroom by the inviting homeserver.\n\nThis endpoint is preferred over the v1 API as it is more useful for servers. Senders\nwhich receive a 400 or 404 response to this endpoint should retry using the v1\nAPI as the server may be older, if the room version is \"1\" or \"2\".\n\nNote that events have a different format depending on the room version - check the\n`room version specification`_ for precise event formats. **The request and response\nbodies here describe the common event fields in more detail and may be missing other\nrequired fields for a PDU.**",
                "example": {
                    "req": "PUT /_matrix/federation/v2/invite/%21abc123%3Amatrix.org/%24abc123%3Aexample.org HTTP/1.1\nContent-Type: application/json\n\n{\n  \"room_version\": \"2\",\n  \"event\": {\n    \"sender\": \"@someone:example.org\",\n    \"origin\": \"matrix.org\",\n    \"origin_server_ts\": 1234567890,\n    \"type\": \"m.room.member\",\n    \"state_key\": \"@joe:elsewhere.com\",\n    \"content\": {\n      \"membership\": \"invite\"\n    }\n  },\n  \"invite_room_state\": [\n    {\n      \"type\": \"m.room.name\",\n      \"sender\": \"@bob:example.org\",\n      \"state_key\": \"\",\n      \"content\": {\n        \"name\": \"Example Room\"\n      }\n    },\n    {\n      \"type\": \"m.room.join_rules\",\n      \"sender\": \"@bob:example.org\",\n      \"state_key\": \"\",\n      \"content\": {\n        \"join_rule\": \"invite\"\n      }\n    }\n  ]\n}"
                },
                "method": "PUT",
                "path": "/_matrix/federation/v2/invite/{roomId}/{eventId}",
                "rate_limited": false,
                "req_body_tables": [
                    [
                        "InviteEvent",
                        null,
                        [
                            {
                                "desc": "**Required.** The matrix ID of the user who sent the original ``m.room.third_party_invite``.",
                                "key": "sender",
                                "required": true,
                                "title": "string"
                            },
                            {
                                "desc": "**Required.** The name of the inviting homeserver.",
                                "key": "origin",
                                "required": true,
                                "title": "string"
                            },
                            {
                                "desc": "**Required.** A timestamp added by the inviting homeserver.",
                                "key": "origin_server_ts",
                                "required": true,
                                "title": "integer"
                            },
                            {
                                "desc": "**Required.** The value ``m.room.member``.",
                                "key": "type",
                                "required": true,
                                "title": "string"
                            },
                            {
                                "desc": "**Required.** The user ID of the invited member.",
                                "key": "state_key",
                                "required": true,
                                "title": "string"
                            },
                            {
                                "desc": "**Required.** The content of the event, matching what is available in the\n`Client-Server API`_. Must include a ``membership`` of ``invite``.",
                                "key": "content",
                                "required": true,
                                "title": "Membership Event Content"
                            }
                        ]
                    ],
                    [
                        "Membership Event Content",
                        null,
                        [
                            {
                                "desc": "**Required.** The value ``invite``.",
                                "key": "membership",
                                "required": true,
                                "title": "string"
                            }
                        ]
                    ],
                    [
                        "StrippedState",
                        null,
                        [
                            {
                                "desc": "**Required.** The ``content`` for the event.",
                                "key": "content",
                                "required": true,
                                "title": "EventContent"
                            },
                            {
                                "desc": "**Required.** The ``state_key`` for the event.",
                                "key": "state_key",
                                "required": true,
                                "title": "string"
                            },
                            {
                                "desc": "**Required.** The ``type`` for the event.",
                                "key": "type",
                                "required": true,
                                "title": "string"
                            },
                            {
                                "desc": "**Required.** The ``sender`` for the event.",
                                "key": "sender",
                                "required": true,
                                "title": "string"
                            }
                        ]
                    ]
                ],
                "req_param_by_loc": {
                    "JSON body": [
                        {
                            "desc": "**Required.** The version of the room where the user is being invited to.",
                            "key": "room_version",
                            "required": true,
                            "title": "string"
                        },
                        {
                            "desc": "**Required.** An invite event. Note that events have a different format depending on the\nroom version - check the `room version specification`_ for precise event formats.",
                            "key": "event",
                            "required": true,
                            "title": "InviteEvent"
                        },
                        {
                            "desc": "An optional list of simplified events to help the receiver of the invite\nidentify the room. The recommended events to include are the join rules,\ncanonical alias, avatar, and name of the room.",
                            "key": "invite_room_state",
                            "required": false,
                            "title": "[StrippedState]"
                        }
                    ],
                    "path": [
                        {
                            "desc": "**Required.** The room ID that the user is being invited to.",
                            "key": "roomId",
                            "required": false,
                            "title": "string"
                        },
                        {
                            "desc": "**Required.** The event ID for the invite event, generated by the inviting server.",
                            "key": "eventId",
                            "required": false,
                            "title": "string"
                        }
                    ]
                },
                "requires_auth": true,
                "res_headers": null,
                "res_tables": [
                    [
                        "Event Container",
                        null,
                        [
                            {
                                "desc": "**Required.** An invite event. Note that events have a different format depending on the\nroom version - check the `room version specification`_ for precise event formats.",
                                "key": "event",
                                "required": true,
                                "title": "InviteEvent"
                            }
                        ]
                    ],
                    [
                        "InviteEvent",
                        null,
                        [
                            {
                                "desc": "**Required.** The matrix ID of the user who sent the original ``m.room.third_party_invite``.",
                                "key": "sender",
                                "required": true,
                                "title": "string"
                            },
                            {
                                "desc": "**Required.** The name of the inviting homeserver.",
                                "key": "origin",
                                "required": true,
                                "title": "string"
                            },
                            {
                                "desc": "**Required.** A timestamp added by the inviting homeserver.",
                                "key": "origin_server_ts",
                                "required": true,
                                "title": "integer"
                            },
                            {
                                "desc": "**Required.** The value ``m.room.member``.",
                                "key": "type",
                                "required": true,
                                "title": "string"
                            },
                            {
                                "desc": "**Required.** The user ID of the invited member.",
                                "key": "state_key",
                                "required": true,
                                "title": "string"
                            },
                            {
                                "desc": "**Required.** The content of the event, matching what is available in the\n`Client-Server API`_. Must include a ``membership`` of ``invite``.",
                                "key": "content",
                                "required": true,
                                "title": "Membership Event Content"
                            }
                        ]
                    ],
                    [
                        "Membership Event Content",
                        null,
                        [
                            {
                                "desc": "**Required.** The value ``invite``.",
                                "key": "membership",
                                "required": true,
                                "title": "string"
                            }
                        ]
                    ]
                ],
                "responses": [
                    {
                        "code": 200,
                        "description": "The event with the invited server's signature added. All other fields of the events\nshould remain untouched. Note that events have a different format depending on the\nroom version - check the `room version specification`_ for precise event formats.",
                        "example": "{\n  \"event\": {\n    \"type\": \"m.room.member\",\n    \"room_id\": \"!somewhere:example.org\",\n    \"content\": {\n      \"membership\": \"invite\"\n    },\n    \"state_key\": \"@someone:example.org\",\n    \"origin\": \"example.org\",\n    \"origin_server_ts\": 1549041175876,\n    \"sender\": \"@someone:example.org\",\n    \"unsigned\": {\n      \"invite_room_state\": [\n        {\n          \"type\": \"m.room.name\",\n          \"sender\": \"@bob:example.org\",\n          \"state_key\": \"\",\n          \"content\": {\n            \"name\": \"Example Room\"\n          }\n        },\n        {\n          \"type\": \"m.room.join_rules\",\n          \"sender\": \"@bob:example.org\",\n          \"state_key\": \"\",\n          \"content\": {\n            \"join_rule\": \"invite\"\n          }\n        }\n      ]\n    },\n    \"signatures\": {\n      \"example.com\": {\n        \"ed25519:key_version\": \"SomeSignatureHere\"\n      },\n      \"elsewhere.com\": {\n        \"ed25519:k3y_versi0n\": \"SomeOtherSignatureHere\"\n      }\n    }\n  }\n}"
                    },
                    {
                        "code": 400,
                        "description": "The request is invalid or the room the server is attempting\nto join has a version that is not listed in the ``ver``\nparameters.\n\nThe error should be passed through to clients so that they\nmay give better feedback to users.",
                        "example": "{\n  \"errcode\": \"M_INCOMPATIBLE_ROOM_VERSION\",\n  \"error\": \"Your homeserver does not support the features required to join this room\",\n  \"room_version\": \"3\"\n}"
                    },
                    {
                        "code": 403,
                        "description": "The invite is not allowed. This could be for a number of reasons, including:\n\n* The sender is not allowed to send invites to the target user/homeserver.\n* The homeserver does not permit anyone to invite its users.\n* The homeserver refuses to participate in the room.",
                        "example": "{\n  \"errcode\": \"M_FORBIDDEN\",\n  \"error\": \"User cannot invite the target user.\"\n}"
                    }
                ],
                "title": "Invites a remote user to a room"
            }
        ],
        "group": "invites_v2_ss"
    },
    "basePath": "/_matrix/federation/v2",
    "consumes": [
        "application/json"
    ],
    "host": "localhost:8448",
    "info": {
        "title": "Matrix Federation Invite User To Room API",
        "version": "1.0.0"
    },
    "paths": {
        "/invite/{roomId}/{eventId}": {
            "put": {
                "description": ".. Note::\n   This API is nearly identical to the v1 API with the exception of the request\n   body being different, and the response format fixed.\n\nInvites a remote user to a room. Once the event has been  signed by both the inviting\nhomeserver and the invited homeserver, it can be sent to all of the servers in the\nroom by the inviting homeserver.\n\nThis endpoint is preferred over the v1 API as it is more useful for servers. Senders\nwhich receive a 400 or 404 response to this endpoint should retry using the v1\nAPI as the server may be older, if the room version is \"1\" or \"2\".\n\nNote that events have a different format depending on the room version - check the\n`room version specification`_ for precise event formats. **The request and response\nbodies here describe the common event fields in more detail and may be missing other\nrequired fields for a PDU.**",
                "operationId": "sendInviteV2",
                "parameters": [
                    {
                        "description": "The room ID that the user is being invited to.",
                        "in": "path",
                        "name": "roomId",
                        "required": true,
                        "type": "string",
                        "x-example": "!abc123:matrix.org"
                    },
                    {
                        "description": "The event ID for the invite event, generated by the inviting server.",
                        "in": "path",
                        "name": "eventId",
                        "required": true,
                        "type": "string",
                        "x-example": "$abc123:example.org"
                    },
                    {
                        "example": {
                            "event": {
                                "content": {
                                    "membership": "invite"
                                },
                                "origin": "example.org",
                                "origin_server_ts": 1549041175876,
                                "room_id": "!somewhere:example.org",
                                "sender": "@someone:example.org",
                                "signatures": {
                                    "example.com": {
                                        "ed25519:key_version": "SomeSignatureHere"
                                    }
                                },
                                "state_key": "@joe:elsewhere.com",
                                "type": "m.room.member"
                            },
                            "room_version": "2"
                        },
                        "in": "body",
                        "name": "body",
                        "required": true,
                        "schema": {
                            "properties": {
                                "event": {
                                    "allOf": [
                                        {
                                            "properties": {
                                                "content": {
                                                    "description": "The content of the event, matching what is available in the\n`Client-Server API`_. Must include a ``membership`` of ``invite``.",
                                                    "example": {
                                                        "membership": "invite"
                                                    },
                                                    "properties": {
                                                        "membership": {
                                                            "description": "The value ``invite``.",
                                                            "example": "invite",
                                                            "type": "string"
                                                        }
                                                    },
                                                    "required": [
                                                        "membership"
                                                    ],
                                                    "title": "Membership Event Content",
                                                    "type": "object"
                                                },
                                                "origin": {
                                                    "description": "The name of the inviting homeserver.",
                                                    "example": "matrix.org",
                                                    "type": "string"
                                                },
                                                "origin_server_ts": {
                                                    "description": "A timestamp added by the inviting homeserver.",
                                                    "example": 1234567890,
                                                    "format": "int64",
                                                    "type": "integer"
                                                },
                                                "sender": {
                                                    "description": "The matrix ID of the user who sent the original ``m.room.third_party_invite``.",
                                                    "example": "@someone:example.org",
                                                    "type": "string"
                                                },
                                                "state_key": {
                                                    "description": "The user ID of the invited member.",
                                                    "example": "@joe:elsewhere.com",
                                                    "type": "string"
                                                },
                                                "type": {
                                                    "description": "The value ``m.room.member``.",
                                                    "example": "m.room.member",
                                                    "type": "string"
                                                }
                                            },
                                            "required": [
                                                "state_key",
                                                "sender",
                                                "origin",
                                                "origin_server_ts",
                                                "type",
                                                "content"
                                            ],
                                            "type": "object"
                                        }
                                    ],
                                    "description": "An invite event. Note that events have a different format depending on the\nroom version - check the `room version specification`_ for precise event formats.",
                                    "title": "InviteEvent",
                                    "type": "object"
                                },
                                "invite_room_state": {
                                    "description": "An optional list of simplified events to help the receiver of the invite\nidentify the room. The recommended events to include are the join rules,\ncanonical alias, avatar, and name of the room.",
                                    "example": [
                                        {
                                            "content": {
                                                "name": "Example Room"
                                            },
                                            "sender": "@bob:example.org",
                                            "state_key": "",
                                            "type": "m.room.name"
                                        },
                                        {
                                            "content": {
                                                "join_rule": "invite"
                                            },
                                            "sender": "@bob:example.org",
                                            "state_key": "",
                                            "type": "m.room.join_rules"
                                        }
                                    ],
                                    "items": {
                                        "description": "A stripped down state event, with only the ``type``, ``state_key``,\n``sender``, and ``content`` keys.",
                                        "properties": {
                                            "content": {
                                                "description": "The ``content`` for the event.",
                                                "title": "EventContent",
                                                "type": "object"
                                            },
                                            "sender": {
                                                "description": "The ``sender`` for the event.",
                                                "type": "string"
                                            },
                                            "state_key": {
                                                "description": "The ``state_key`` for the event.",
                                                "type": "string"
                                            },
                                            "type": {
                                                "description": "The ``type`` for the event.",
                                                "type": "string"
                                            }
                                        },
                                        "required": [
                                            "type",
                                            "state_key",
                                            "content",
                                            "sender"
                                        ],
                                        "title": "StrippedState",
                                        "type": "object"
                                    },
                                    "type": "array"
                                },
                                "room_version": {
                                    "description": "The version of the room where the user is being invited to.",
                                    "example": "2",
                                    "type": "string"
                                }
                            },
                            "required": [
                                "room_version",
                                "event"
                            ],
                            "type": "object"
                        },
                        "type": "object"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "The event with the invited server's signature added. All other fields of the events\nshould remain untouched. Note that events have a different format depending on the\nroom version - check the `room version specification`_ for precise event formats.",
                        "examples": {
                            "application/json": {
                                "event": {
                                    "content": {
                                        "membership": "invite"
                                    },
                                    "origin": "example.org",
                                    "origin_server_ts": 1549041175876,
                                    "room_id": "!somewhere:example.org",
                                    "sender": "@someone:example.org",
                                    "signatures": {
                                        "elsewhere.com": {
                                            "ed25519:k3y_versi0n": "SomeOtherSignatureHere"
                                        },
                                        "example.com": {
                                            "ed25519:key_version": "SomeSignatureHere"
                                        }
                                    },
                                    "state_key": "@someone:example.org",
                                    "type": "m.room.member",
                                    "unsigned": {
                                        "invite_room_state": [
                                            {
                                                "content": {
                                                    "name": "Example Room"
                                                },
                                                "sender": "@bob:example.org",
                                                "state_key": "",
                                                "type": "m.room.name"
                                            },
                                            {
                                                "content": {
                                                    "join_rule": "invite"
                                                },
                                                "sender": "@bob:example.org",
                                                "state_key": "",
                                                "type": "m.room.join_rules"
                                            }
                                        ]
                                    }
                                }
                            }
                        },
                        "schema": {
                            "description": "An object containing the signed invite event.",
                            "properties": {
                                "event": {
                                    "allOf": [
                                        {
                                            "properties": {
                                                "content": {
                                                    "description": "The content of the event, matching what is available in the\n`Client-Server API`_. Must include a ``membership`` of ``invite``.",
                                                    "example": {
                                                        "membership": "invite"
                                                    },
                                                    "properties": {
                                                        "membership": {
                                                            "description": "The value ``invite``.",
                                                            "example": "invite",
                                                            "type": "string"
                                                        }
                                                    },
                                                    "required": [
                                                        "membership"
                                                    ],
                                                    "title": "Membership Event Content",
                                                    "type": "object"
                                                },
                                                "origin": {
                                                    "description": "The name of the inviting homeserver.",
                                                    "example": "matrix.org",
                                                    "type": "string"
                                                },
                                                "origin_server_ts": {
                                                    "description": "A timestamp added by the inviting homeserver.",
                                                    "example": 1234567890,
                                                    "format": "int64",
                                                    "type": "integer"
                                                },
                                                "sender": {
                                                    "description": "The matrix ID of the user who sent the original ``m.room.third_party_invite``.",
                                                    "example": "@someone:example.org",
                                                    "type": "string"
                                                },
                                                "state_key": {
                                                    "description": "The user ID of the invited member.",
                                                    "example": "@joe:elsewhere.com",
                                                    "type": "string"
                                                },
                                                "type": {
                                                    "description": "The value ``m.room.member``.",
                                                    "example": "m.room.member",
                                                    "type": "string"
                                                }
                                            },
                                            "required": [
                                                "state_key",
                                                "sender",
                                                "origin",
                                                "origin_server_ts",
                                                "type",
                                                "content"
                                            ],
                                            "type": "object"
                                        }
                                    ],
                                    "description": "An invite event. Note that events have a different format depending on the\nroom version - check the `room version specification`_ for precise event formats.",
                                    "title": "InviteEvent",
                                    "type": "object"
                                }
                            },
                            "required": [
                                "event"
                            ],
                            "title": "Event Container",
                            "type": "object"
                        }
                    },
                    "400": {
                        "description": "The request is invalid or the room the server is attempting\nto join has a version that is not listed in the ``ver``\nparameters.\n\nThe error should be passed through to clients so that they\nmay give better feedback to users.",
                        "examples": {
                            "application/json": {
                                "errcode": "M_INCOMPATIBLE_ROOM_VERSION",
                                "error": "Your homeserver does not support the features required to join this room",
                                "room_version": "3"
                            }
                        },
                        "schema": {
                            "allOf": [
                                {
                                    "description": "A Matrix-level Error",
                                    "properties": {
                                        "errcode": {
                                            "description": "An error code.",
                                            "example": "M_UNKNOWN",
                                            "type": "string"
                                        },
                                        "error": {
                                            "description": "A human-readable error message.",
                                            "example": "An unknown error occurred",
                                            "type": "string"
                                        }
                                    },
                                    "required": [
                                        "errcode"
                                    ],
                                    "type": "object"
                                },
                                {
                                    "properties": {
                                        "room_version": {
                                            "description": "The version of the room. Required if the ``errcode``\nis ``M_INCOMPATIBLE_ROOM_VERSION``.",
                                            "type": "string"
                                        }
                                    },
                                    "type": "object"
                                }
                            ]
                        }
                    },
                    "403": {
                        "description": "The invite is not allowed. This could be for a number of reasons, including:\n\n* The sender is not allowed to send invites to the target user/homeserver.\n* The homeserver does not permit anyone to invite its users.\n* The homeserver refuses to participate in the room.",
                        "examples": {
                            "application/json": {
                                "errcode": "M_FORBIDDEN",
                                "error": "User cannot invite the target user."
                            }
                        },
                        "schema": {
                            "description": "A Matrix-level Error",
                            "properties": {
                                "errcode": {
                                    "description": "An error code.",
                                    "example": "M_UNKNOWN",
                                    "type": "string"
                                },
                                "error": {
                                    "description": "A human-readable error message.",
                                    "example": "An unknown error occurred",
                                    "type": "string"
                                }
                            },
                            "required": [
                                "errcode"
                            ],
                            "type": "object"
                        }
                    }
                },
                "security": [
                    {
                        "signedRequest": []
                    }
                ],
                "summary": "Invites a remote user to a room"
            }
        }
    },
    "produces": [
        "application/json"
    ],
    "schemes": [
        "https"
    ],
    "securityDefinitions": {
        "signedRequest": {
            "description": "The ``Authorization`` header defined in the `Authentication`_ section.",
            "in": "header",
            "name": "Authorization",
            "type": "apiKey"
        }
    },
    "swagger": "2.0"
}