{
    "__meta": {
        "base": "/_matrix/push/v1",
        "endpoints": [
            {
                "deprecated": false,
                "desc": "This endpoint is invoked by HTTP pushers to notify a push gateway about\nan event or update the number of unread notifications a user has.\nIn the former case it will contain selected information about the event.\nIn either case it may contain numeric counts of the number of unread\nevents of different types the user has. The counts may be sent along\nwith a notification about an event or by themselves.\n\nNotifications about a particular event will normally cause the user to be\nalerted in some way. It is therefore necessary to perform duplicate\nsuppression for such notifications using the ``event_id`` field to avoid\nretries of this HTTP API causing duplicate alerts. The operation of\nupdating counts of unread notifications should be idempotent and\ntherefore do not require duplicate suppression.\n\nNotifications are sent to the URL configured when the pusher is created.\nThis means that the HTTP path may be different depending on the push\ngateway.",
                "example": {
                    "req": "POST /_matrix/push/v1/notify HTTP/1.1\nContent-Type: application/json\n\n{\n  \"notification\": {\n    \"event_id\": \"$3957tyerfgewrf384\",\n    \"room_id\": \"!slw48wfj34rtnrf:example.com\",\n    \"type\": \"m.room.message\",\n    \"sender\": \"@exampleuser:matrix.org\",\n    \"sender_display_name\": \"Major Tom\",\n    \"room_name\": \"Mission Control\",\n    \"room_alias\": \"#exampleroom:matrix.org\",\n    \"prio\": \"high\",\n    \"content\": {\n      \"msgtype\": \"m.text\",\n      \"body\": \"I'm floating in a most peculiar way.\"\n    },\n    \"counts\": {\n      \"unread\": 2,\n      \"missed_calls\": 1\n    },\n    \"devices\": [\n      {\n        \"app_id\": \"org.matrix.matrixConsole.ios\",\n        \"pushkey\": \"V2h5IG9uIGVhcnRoIGRpZCB5b3UgZGVjb2RlIHRoaXM/\",\n        \"pushkey_ts\": 12345678,\n        \"data\": {},\n        \"tweaks\": {\n          \"sound\": \"bing\"\n        }\n      }\n    ]\n  }\n}"
                },
                "method": "POST",
                "path": "/_matrix/push/v1/notify",
                "rate_limited": false,
                "req_body_tables": [
                    [
                        "Notification",
                        null,
                        [
                            {
                                "desc": "The Matrix event ID of the event being notified about.\nThis is required if the notification is about a\nparticular Matrix event. It may be omitted for notifications\nthat only contain updated badge counts. This ID can and\nshould be used to detect duplicate notification requests.",
                                "key": "event_id",
                                "required": false,
                                "title": "string"
                            },
                            {
                                "desc": "The ID of the room in which this event occurred.\nRequired if the notification relates to a specific\nMatrix event.",
                                "key": "room_id",
                                "required": false,
                                "title": "string"
                            },
                            {
                                "desc": "The type of the event as in the event's ``type`` field.",
                                "key": "type",
                                "required": false,
                                "title": "string"
                            },
                            {
                                "desc": "The sender of the event as in the corresponding event field.",
                                "key": "sender",
                                "required": false,
                                "title": "string"
                            },
                            {
                                "desc": "The current display name of the sender in the room in which\nthe event occurred.",
                                "key": "sender_display_name",
                                "required": false,
                                "title": "string"
                            },
                            {
                                "desc": "The name of the room in which the event occurred.",
                                "key": "room_name",
                                "required": false,
                                "title": "string"
                            },
                            {
                                "desc": "An alias to display for the room in which the event occurred.",
                                "key": "room_alias",
                                "required": false,
                                "title": "string"
                            },
                            {
                                "desc": "This is true if the user receiving the notification is the\nsubject of a member event (i.e. the ``state_key`` of the\nmember event is equal to the user's Matrix ID).",
                                "key": "user_is_target",
                                "required": false,
                                "title": "boolean"
                            },
                            {
                                "desc": "The priority of the notification. If omitted, ``high`` is\nassumed. This may be used by push gateways to deliver less\ntime-sensitive notifications in a way that will preserve\nbattery power on mobile devices. One of: [\"high\", \"low\"]",
                                "key": "prio",
                                "required": false,
                                "title": "enum"
                            },
                            {
                                "desc": "The ``content`` field from the event, if present. The pusher\nmay omit this if the event had no content or for any other\nreason.",
                                "key": "content",
                                "required": false,
                                "title": "EventContent"
                            },
                            {
                                "desc": "This is a dictionary of the current number of unacknowledged\ncommunications for the recipient user. Counts whose value is\nzero should be omitted.",
                                "key": "counts",
                                "required": false,
                                "title": "Counts"
                            },
                            {
                                "desc": "**Required.** This is an array of devices that the notification should be sent to.",
                                "key": "devices",
                                "required": true,
                                "title": "[Device]"
                            }
                        ]
                    ],
                    [
                        "Counts",
                        null,
                        [
                            {
                                "desc": "The number of unread messages a user has across all of the\nrooms they are a member of.",
                                "key": "unread",
                                "required": false,
                                "title": "integer"
                            },
                            {
                                "desc": "The number of unacknowledged missed calls a user has\nacross all rooms of which they are a member.",
                                "key": "missed_calls",
                                "required": false,
                                "title": "integer"
                            }
                        ]
                    ],
                    [
                        "Device",
                        null,
                        [
                            {
                                "desc": "**Required.** The ``app_id`` given when the pusher was created.",
                                "key": "app_id",
                                "required": true,
                                "title": "string"
                            },
                            {
                                "desc": "**Required.** The ``pushkey`` given when the pusher was created.",
                                "key": "pushkey",
                                "required": true,
                                "title": "string"
                            },
                            {
                                "desc": "The unix timestamp (in seconds) when the\npushkey was last updated.",
                                "key": "pushkey_ts",
                                "required": false,
                                "title": "integer"
                            },
                            {
                                "desc": "A dictionary of additional pusher-specific data. For\n'http' pushers, this is the data dictionary passed in at\npusher creation minus the ``url`` key.",
                                "key": "data",
                                "required": false,
                                "title": "PusherData"
                            },
                            {
                                "desc": "A dictionary of customisations made to the way this\nnotification is to be presented. These are added by push rules.",
                                "key": "tweaks",
                                "required": false,
                                "title": "Tweaks"
                            }
                        ]
                    ]
                ],
                "req_param_by_loc": {
                    "JSON body": [
                        {
                            "desc": "**Required.** Information about the push notification",
                            "key": "notification",
                            "required": true,
                            "title": "Notification"
                        }
                    ]
                },
                "requires_auth": false,
                "res_headers": null,
                "res_tables": [
                    [
                        null,
                        null,
                        [
                            {
                                "desc": "**Required.** A list of all pushkeys given in the notification request that\nare not valid. These could have been rejected by an upstream\ngateway because they have expired or have never been valid.\nHomeservers must cease sending notification requests for these\npushkeys and remove the associated pushers. It may not\nnecessarily be the notification in the request that failed:\nit could be that a previous notification to the same pushkey\nfailed. May be empty.",
                                "key": "rejected",
                                "required": true,
                                "title": "[string]"
                            }
                        ]
                    ]
                ],
                "responses": [
                    {
                        "code": 200,
                        "description": "A list of rejected push keys.",
                        "example": "{\n  \"rejected\": [\n    \"V2h5IG9uIGVhcnRoIGRpZCB5b3UgZGVjb2RlIHRoaXM/\"\n  ]\n}"
                    }
                ],
                "title": "Notify a push gateway about an event."
            }
        ],
        "group": "push_notifier_push"
    },
    "basePath": "/_matrix/push/v1",
    "consumes": [
        "application/json"
    ],
    "host": "localhost:8008",
    "info": {
        "title": "Matrix Push Notification API",
        "version": "1.0.0"
    },
    "paths": {
        "/notify": {
            "post": {
                "description": "This endpoint is invoked by HTTP pushers to notify a push gateway about\nan event or update the number of unread notifications a user has.\nIn the former case it will contain selected information about the event.\nIn either case it may contain numeric counts of the number of unread\nevents of different types the user has. The counts may be sent along\nwith a notification about an event or by themselves.\n\nNotifications about a particular event will normally cause the user to be\nalerted in some way. It is therefore necessary to perform duplicate\nsuppression for such notifications using the ``event_id`` field to avoid\nretries of this HTTP API causing duplicate alerts. The operation of\nupdating counts of unread notifications should be idempotent and\ntherefore do not require duplicate suppression.\n\nNotifications are sent to the URL configured when the pusher is created.\nThis means that the HTTP path may be different depending on the push\ngateway.",
                "operationId": "notify",
                "parameters": [
                    {
                        "description": "Information about the push notification.",
                        "in": "body",
                        "name": "notification",
                        "required": true,
                        "schema": {
                            "example": {
                                "notification": {
                                    "content": {
                                        "body": "I'm floating in a most peculiar way.",
                                        "msgtype": "m.text"
                                    },
                                    "counts": {
                                        "missed_calls": 1,
                                        "unread": 2
                                    },
                                    "devices": [
                                        {
                                            "app_id": "org.matrix.matrixConsole.ios",
                                            "data": {},
                                            "pushkey": "V2h5IG9uIGVhcnRoIGRpZCB5b3UgZGVjb2RlIHRoaXM/",
                                            "pushkey_ts": 12345678,
                                            "tweaks": {
                                                "sound": "bing"
                                            }
                                        }
                                    ],
                                    "event_id": "$3957tyerfgewrf384",
                                    "prio": "high",
                                    "room_alias": "#exampleroom:matrix.org",
                                    "room_id": "!slw48wfj34rtnrf:example.com",
                                    "room_name": "Mission Control",
                                    "sender": "@exampleuser:matrix.org",
                                    "sender_display_name": "Major Tom",
                                    "type": "m.room.message"
                                }
                            },
                            "properties": {
                                "notification": {
                                    "description": "Information about the push notification",
                                    "properties": {
                                        "content": {
                                            "description": "The ``content`` field from the event, if present. The pusher\nmay omit this if the event had no content or for any other\nreason.",
                                            "title": "EventContent",
                                            "type": "object"
                                        },
                                        "counts": {
                                            "description": "This is a dictionary of the current number of unacknowledged\ncommunications for the recipient user. Counts whose value is\nzero should be omitted.",
                                            "properties": {
                                                "missed_calls": {
                                                    "description": "The number of unacknowledged missed calls a user has\nacross all rooms of which they are a member.",
                                                    "type": "integer"
                                                },
                                                "unread": {
                                                    "description": "The number of unread messages a user has across all of the\nrooms they are a member of.",
                                                    "type": "integer"
                                                }
                                            },
                                            "title": "Counts",
                                            "type": "object"
                                        },
                                        "devices": {
                                            "description": "This is an array of devices that the notification should be sent to.",
                                            "items": {
                                                "properties": {
                                                    "app_id": {
                                                        "description": "The ``app_id`` given when the pusher was created.",
                                                        "type": "string"
                                                    },
                                                    "data": {
                                                        "description": "A dictionary of additional pusher-specific data. For\n'http' pushers, this is the data dictionary passed in at\npusher creation minus the ``url`` key.",
                                                        "title": "PusherData",
                                                        "type": "object"
                                                    },
                                                    "pushkey": {
                                                        "description": "The ``pushkey`` given when the pusher was created.",
                                                        "type": "string"
                                                    },
                                                    "pushkey_ts": {
                                                        "description": "The unix timestamp (in seconds) when the\npushkey was last updated.",
                                                        "type": "integer"
                                                    },
                                                    "tweaks": {
                                                        "description": "A dictionary of customisations made to the way this\nnotification is to be presented. These are added by push rules.",
                                                        "title": "Tweaks",
                                                        "type": "object"
                                                    }
                                                },
                                                "required": [
                                                    "app_id",
                                                    "pushkey"
                                                ],
                                                "title": "Device",
                                                "type": "object"
                                            },
                                            "title": "Devices",
                                            "type": "array"
                                        },
                                        "event_id": {
                                            "description": "The Matrix event ID of the event being notified about.\nThis is required if the notification is about a\nparticular Matrix event. It may be omitted for notifications\nthat only contain updated badge counts. This ID can and\nshould be used to detect duplicate notification requests.",
                                            "type": "string"
                                        },
                                        "prio": {
                                            "description": "The priority of the notification. If omitted, ``high`` is\nassumed. This may be used by push gateways to deliver less\ntime-sensitive notifications in a way that will preserve\nbattery power on mobile devices.",
                                            "enum": [
                                                "high",
                                                "low"
                                            ],
                                            "type": "string"
                                        },
                                        "room_alias": {
                                            "description": "An alias to display for the room in which the event occurred.",
                                            "type": "string"
                                        },
                                        "room_id": {
                                            "description": "The ID of the room in which this event occurred.\nRequired if the notification relates to a specific\nMatrix event.",
                                            "type": "string"
                                        },
                                        "room_name": {
                                            "description": "The name of the room in which the event occurred.",
                                            "type": "string"
                                        },
                                        "sender": {
                                            "description": "The sender of the event as in the corresponding event field.",
                                            "type": "string"
                                        },
                                        "sender_display_name": {
                                            "description": "The current display name of the sender in the room in which\nthe event occurred.",
                                            "type": "string"
                                        },
                                        "type": {
                                            "description": "The type of the event as in the event's ``type`` field.",
                                            "type": "string"
                                        },
                                        "user_is_target": {
                                            "description": "This is true if the user receiving the notification is the\nsubject of a member event (i.e. the ``state_key`` of the\nmember event is equal to the user's Matrix ID).",
                                            "type": "boolean"
                                        }
                                    },
                                    "required": [
                                        "devices"
                                    ],
                                    "title": "Notification",
                                    "type": "object"
                                }
                            },
                            "required": [
                                "notification"
                            ],
                            "type": "object"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "A list of rejected push keys.",
                        "examples": {
                            "application/json": {
                                "rejected": [
                                    "V2h5IG9uIGVhcnRoIGRpZCB5b3UgZGVjb2RlIHRoaXM/"
                                ]
                            }
                        },
                        "schema": {
                            "properties": {
                                "rejected": {
                                    "description": "A list of all pushkeys given in the notification request that\nare not valid. These could have been rejected by an upstream\ngateway because they have expired or have never been valid.\nHomeservers must cease sending notification requests for these\npushkeys and remove the associated pushers. It may not\nnecessarily be the notification in the request that failed:\nit could be that a previous notification to the same pushkey\nfailed. May be empty.",
                                    "items": {
                                        "description": "A pushkey that has been rejected.",
                                        "type": "string"
                                    },
                                    "type": "array"
                                }
                            },
                            "required": [
                                "rejected"
                            ],
                            "type": "object"
                        }
                    }
                },
                "summary": "Notify a push gateway about an event."
            }
        }
    },
    "produces": [
        "application/json"
    ],
    "schemes": [
        "https",
        "http"
    ],
    "swagger": "2.0"
}