[
    {
        "additional_types": [
            {
                "name": "Signatures",
                "properties": []
            },
            {
                "name": "DeviceKeys",
                "properties": [
                    {
                        "description": "The ID of the user the device belongs to. Must match the user ID used\nwhen logging in.",
                        "name": "user_id",
                        "required": true,
                        "type": "string"
                    },
                    {
                        "description": "The ID of the device these keys belong to. Must match the device ID used\nwhen logging in.",
                        "name": "device_id",
                        "required": true,
                        "type": "string"
                    },
                    {
                        "description": "The encryption algorithms supported by this device.",
                        "name": "algorithms",
                        "required": true,
                        "type": "[string]"
                    },
                    {
                        "description": "Public identity keys. The names of the properties should be in the\nformat ``<algorithm>:<device_id>``. The keys themselves should be\nencoded as specified by the key algorithm.",
                        "name": "keys",
                        "required": true,
                        "type": "object"
                    },
                    {
                        "description": "Signatures for the device key object. A map from user ID, to a map from\n``<algorithm>:<device_id>`` to the signature.\n\nThe signature is calculated using the process described at `Signing\nJSON`_.",
                        "name": "signatures",
                        "required": true,
                        "type": "Signatures"
                    }
                ]
            }
        ],
        "basePath": "/_matrix/client/%CLIENT_MAJOR_VERSION%",
        "description": "Publishes end-to-end encryption keys for the device.",
        "method": "POST",
        "parameters": {
            "Body": [
                {
                    "description": "Identity keys for the device. May be absent if no new\nidentity keys are required.",
                    "name": "device_keys",
                    "required": false,
                    "type": "DeviceKeys"
                },
                {
                    "description": "One-time public keys for \"pre-key\" messages.  The names of\nthe properties should be in the format\n``<algorithm>:<key_id>``. The format of the key is determined\nby the `key algorithm <#key-algorithms>`_.\n\nMay be absent if no new one-time keys are required.",
                    "name": "one_time_keys",
                    "required": false,
                    "type": "object"
                }
            ],
            "Form": [],
            "Header": [],
            "Path": [],
            "Query": []
        },
        "path": "/keys/upload",
        "rate_limited": false,
        "requires_auth": true,
        "responses": [
            {
                "additional_types": [],
                "description": "The provided keys were successfully uploaded.",
                "examples": "",
                "parameters": [
                    {
                        "description": "For each key algorithm, the number of unclaimed one-time keys\nof that type currently held on the server for this device.",
                        "name": "one_time_key_counts",
                        "required": true,
                        "type": "object"
                    }
                ],
                "required": false,
                "status": 200
            }
        ],
        "summary": "Upload end-to-end encryption keys."
    },
    {
        "additional_types": [],
        "basePath": "/_matrix/client/%CLIENT_MAJOR_VERSION%",
        "description": "Returns the current devices and identity keys for the given users.",
        "method": "POST",
        "parameters": {
            "Body": [
                {
                    "description": "The time (in milliseconds) to wait when downloading keys from\nremote servers. 10 seconds is the recommended default.",
                    "name": "timeout",
                    "required": false,
                    "type": "integer"
                },
                {
                    "description": "The keys to be downloaded. A map from user ID, to a list of\ndevice IDs, or to an empty list to indicate all devices for the\ncorresponding user.",
                    "name": "device_keys",
                    "required": true,
                    "type": "object"
                },
                {
                    "description": "If the client is fetching keys as a result of a device update received\nin a sync request, this should be the 'since' token of that sync request,\nor any later sync token. This allows the server to ensure its response\ncontains the keys advertised by the notification in that sync.",
                    "name": "token",
                    "required": false,
                    "type": "string"
                }
            ],
            "Form": [],
            "Header": [],
            "Path": [],
            "Query": []
        },
        "path": "/keys/query",
        "rate_limited": false,
        "requires_auth": true,
        "responses": [
            {
                "additional_types": [],
                "description": "The device information",
                "examples": "",
                "parameters": [
                    {
                        "description": "If any remote homeservers could not be reached, they are\nrecorded here. The names of the properties are the names of\nthe unreachable servers.\n\nIf the homeserver could be reached, but the user or device\nwas unknown, no failure is recorded. Instead, the corresponding\nuser or device is missing from the ``device_keys`` result.",
                        "name": "failures",
                        "required": false,
                        "type": "object"
                    },
                    {
                        "description": "Information on the queried devices. A map from user ID, to a\nmap from device ID to device information.  For each device,\nthe information returned will be the same as uploaded via\n``/keys/upload``, with the addition of an ``unsigned``\nproperty.",
                        "name": "device_keys",
                        "required": false,
                        "type": "object"
                    }
                ],
                "required": false,
                "status": 200
            }
        ],
        "summary": "Download device identity keys."
    },
    {
        "additional_types": [],
        "basePath": "/_matrix/client/%CLIENT_MAJOR_VERSION%",
        "description": "Claims one-time keys for use in pre-key messages.",
        "method": "POST",
        "parameters": {
            "Body": [
                {
                    "description": "The time (in milliseconds) to wait when downloading keys from\nremote servers. 10 seconds is the recommended default.",
                    "name": "timeout",
                    "required": false,
                    "type": "integer"
                },
                {
                    "description": "The keys to be claimed. A map from user ID, to a map from\ndevice ID to algorithm name.",
                    "name": "one_time_keys",
                    "required": true,
                    "type": "object"
                }
            ],
            "Form": [],
            "Header": [],
            "Path": [],
            "Query": []
        },
        "path": "/keys/claim",
        "rate_limited": false,
        "requires_auth": true,
        "responses": [
            {
                "additional_types": [],
                "description": "The claimed keys.",
                "examples": "",
                "parameters": [
                    {
                        "description": "If any remote homeservers could not be reached, they are\nrecorded here. The names of the properties are the names of\nthe unreachable servers.\n\nIf the homeserver could be reached, but the user or device\nwas unknown, no failure is recorded. Instead, the corresponding\nuser or device is missing from the ``one_time_keys`` result.",
                        "name": "failures",
                        "required": false,
                        "type": "object"
                    },
                    {
                        "description": "One-time keys for the queried devices. A map from user ID, to a\nmap from devices to a map from ``<algorithm>:<key_id>`` to the key object.\n\nSee the `key algorithms <#key-algorithms>`_ section for information\non the Key Object format.",
                        "name": "one_time_keys",
                        "required": true,
                        "type": "object"
                    }
                ],
                "required": false,
                "status": 200
            }
        ],
        "summary": "Claim one-time encryption keys."
    },
    {
        "additional_types": [],
        "basePath": "/_matrix/client/%CLIENT_MAJOR_VERSION%",
        "description": "Gets a list of users who have updated their device identity keys since a\nprevious sync token.\n\nThe server should include in the results any users who:\n\n* currently share a room with the calling user (ie, both users have\n  membership state ``join``); *and*\n* added new device identity keys or removed an existing device with\n  identity keys, between ``from`` and ``to``.",
        "method": "GET",
        "parameters": {
            "Body": [],
            "Form": [],
            "Header": [],
            "Path": [],
            "Query": [
                {
                    "description": "The desired start point of the list. Should be the ``next_batch`` field\nfrom a response to an earlier call to |/sync|. Users who have not\nuploaded new device identity keys since this point, nor deleted\nexisting devices with identity keys since then, will be excluded\nfrom the results.",
                    "name": "from",
                    "required": true,
                    "type": "string"
                },
                {
                    "description": "The desired end point of the list. Should be the ``next_batch``\nfield from a recent call to |/sync| - typically the most recent\nsuch call. This may be used by the server as a hint to check its\ncaches are up to date.",
                    "name": "to",
                    "required": true,
                    "type": "string"
                }
            ]
        },
        "path": "/keys/changes",
        "rate_limited": false,
        "requires_auth": true,
        "responses": [
            {
                "additional_types": [],
                "description": "The list of users who updated their devices.",
                "examples": "",
                "parameters": [
                    {
                        "description": "The Matrix User IDs of all users who updated their device\nidentity keys.",
                        "name": "changed",
                        "required": false,
                        "type": "[string]"
                    },
                    {
                        "description": "The Matrix User IDs of all users who may have left all\nthe end-to-end encrypted rooms they previously shared\nwith the user.",
                        "name": "left",
                        "required": false,
                        "type": "[string]"
                    }
                ],
                "required": false,
                "status": 200
            }
        ],
        "summary": "Query users with recent device key updates."
    }
]